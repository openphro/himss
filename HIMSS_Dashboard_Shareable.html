<html lang="en"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6IjdiNWFlNDg4ZGU5NDlkNmY0OGJhYzU1ZmMwYTE1NzJlZTJmNjExMzciLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIxNDYyMjc1ODAyNDcyOTgyMjAyNyIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjXzIwZTk5MjQ2YTc1NmJkYzJfaGltc3NfZGFzaGJvYXJkLmh0bWwtMTA3In0sImV4cCI6MTc3MTcxNTkzNSwiaWF0IjoxNzcxNzEyMzM1LCJhbGciOiJSUzI1NiJ9.nT02NdK9GJF_53EkY4pbrovu7X6HciJ9oJQXQ4qV7sR9U-8lW2OXJvTkUMpDo62l0PtTjBgL1TrInmbIj4n0CFJxkcRCvRnA0cosz3KXLqqNvGC1FtCAAql2tKrTAG8QLKDs7mM0PBuadwXVqhy08-YTxXof0PIQIJ-vi3-Ceai9xL9mpw61F7z8EoqQAhDnpBvxjOEQsUF0D-X9HHYSsaaWEk0JUV-pr3-q9AYRopC4Ij_tmtQFLMgYk17_GQgpwp7XQQZX8x7daSCnUmKwRKHgXls1o6F0xdj_8FLcIYdR8oQfBtMSjq7ymHZ0foritY2sfRTfcsc04n2ikiOy6Q","c_20e99246a756bdc2_himss_dashboard.html-107")</script><script>(function(){'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
})();</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageTransformModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });
  modelInformation.deprecatedImageModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predict',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predictLongRunning',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash","imageModelName":"imagen-4.0-generate-001","imageEditModelName":"gemini-2.5-flash-image-preview","imageTransformModelName":"gemini-3-pro-image-preview-11-2025","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20","gemini-2.5-flash-preview-09-2025"],"deprecatedImageModelNames":["imagen-3.0-generate-001","imagen-3.0-generate-002"]})</script><script>(function(){'use strict';function a(){window.parent.postMessage({type:"interaction"},"*")}window.addEventListener("click",a,{capture:!0,passive:!0});window.addEventListener("touchstart",a,{capture:!0,passive:!0});window.addEventListener("keydown",a,{capture:!0,passive:!0});}).call(this);
</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>HIMSS Board Financial Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/lucide@latest" crossorigin="anonymous"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;500;600;700&display=swap');
        
        body { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; background-color: #f8fafc; }
        .serif { font-family: 'Libre Baskerville', serif; }
        
        .theme-navy { background-color: #002D72; }
        .theme-gold { background-color: #A58B53; }
        .text-navy { color: #002D72; }
        .text-gold { color: #A58B53; }
        .border-gold { border-color: #A58B53; }
        
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { height: 6px; width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; rounded: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .tab-btn.active { border-bottom: 3px solid #002D72; color: #002D72; font-weight: 600; }
        .tab-btn { border-bottom: 3px solid transparent; color: #64748b; }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0px}.right-0{right:0px}.top-0{top:0px}.z-10{z-index:10}.z-50{z-index:50}.z-\[100\]{z-index:100}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:0.25rem}.mb-12{margin-bottom:3rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mt-1{margin-top:0.25rem}.mt-10{margin-top:2.5rem}.mt-2{margin-top:0.5rem}.mt-4{margin-top:1rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-16{height:4rem}.h-20{height:5rem}.h-3{height:0.75rem}.h-4{height:1rem}.h-5{height:1.25rem}.h-64{height:16rem}.h-1\.5{height:0.375rem}.h-full{height:100%}.max-h-\[500px\]{max-height:500px}.min-h-\[400px\]{min-height:400px}.min-h-screen{min-height:100vh}.w-10{width:2.5rem}.w-16{width:4rem}.w-20{width:5rem}.w-3{width:0.75rem}.w-4{width:1rem}.w-5{width:1.25rem}.w-full{width:100%}.max-w-7xl{max-width:80rem}.max-w-md{max-width:28rem}.max-w-\[200px\]{max-width:200px}.flex-grow{flex-grow:1}.border-collapse{border-collapse:collapse}.cursor-pointer{cursor:pointer}.list-inside{list-style-position:inside}.list-disc{list-style-type:disc}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.flex-col{flex-direction:column}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-baseline{align-items:baseline}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.divide-y > :not([hidden]) ~ :not([hidden]){--tw-divide-y-reverse:0;border-top-width:calc(1px * calc(1 - var(--tw-divide-y-reverse)));border-bottom-width:calc(1px * var(--tw-divide-y-reverse))}.divide-slate-100 > :not([hidden]) ~ :not([hidden]){--tw-divide-opacity:1;border-color:rgb(241 245 249 / var(--tw-divide-opacity, 1))}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-nowrap{white-space:nowrap}.rounded-2xl{border-radius:1rem}.rounded-full{border-radius:9999px}.rounded-md{border-radius:0.375rem}.rounded-xl{border-radius:0.75rem}.rounded-b-xl{border-bottom-right-radius:0.75rem;border-bottom-left-radius:0.75rem}.rounded-t-xl{border-top-left-radius:0.75rem;border-top-right-radius:0.75rem}.rounded-bl-full{border-bottom-left-radius:9999px}.border{border-width:1px}.border-2{border-width:2px}.border-y{border-top-width:1px;border-bottom-width:1px}.border-b{border-bottom-width:1px}.border-l{border-left-width:1px}.border-t{border-top-width:1px}.border-t-0{border-top-width:0px}.border-t-8{border-top-width:8px}.border-black\/10{border-color:rgb(0 0 0 / 0.1)}.border-blue-100{--tw-border-opacity:1;border-color:rgb(219 234 254 / var(--tw-border-opacity, 1))}.border-slate-100{--tw-border-opacity:1;border-color:rgb(241 245 249 / var(--tw-border-opacity, 1))}.border-slate-200{--tw-border-opacity:1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-slate-300{--tw-border-opacity:1;border-color:rgb(203 213 225 / var(--tw-border-opacity, 1))}.border-white\/20{border-color:rgb(255 255 255 / 0.2)}.bg-blue-50{--tw-bg-opacity:1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-emerald-50{--tw-bg-opacity:1;background-color:rgb(236 253 245 / var(--tw-bg-opacity, 1))}.bg-red-50{--tw-bg-opacity:1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.bg-slate-100{--tw-bg-opacity:1;background-color:rgb(241 245 249 / var(--tw-bg-opacity, 1))}.bg-slate-50{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}.bg-slate-50\/50{background-color:rgb(248 250 252 / 0.5)}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\/10{background-color:rgb(255 255 255 / 0.1)}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-emerald-500{--tw-bg-opacity:1;background-color:rgb(16 185 129 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-slate-200{--tw-bg-opacity:1;background-color:rgb(226 232 240 / var(--tw-bg-opacity, 1))}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-8{padding-top:2rem;padding-bottom:2rem}.pb-3{padding-bottom:0.75rem}.pb-4{padding-bottom:1rem}.pt-2{padding-top:0.5rem}.pt-4{padding-top:1rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.font-serif{font-family:ui-serif, Georgia, Cambria, "Times New Roman", Times, serif}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-\[9px\]{font-size:9px}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.text-\[11px\]{font-size:11px}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.italic{font-style:italic}.tracking-\[0\.2em\]{letter-spacing:0.2em}.tracking-\[0\.3em\]{letter-spacing:0.3em}.tracking-wide{letter-spacing:0.025em}.tracking-wider{letter-spacing:0.05em}.text-emerald-500{--tw-text-opacity:1;color:rgb(16 185 129 / var(--tw-text-opacity, 1))}.text-emerald-600{--tw-text-opacity:1;color:rgb(5 150 105 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-slate-300{--tw-text-opacity:1;color:rgb(203 213 225 / var(--tw-text-opacity, 1))}.text-slate-400{--tw-text-opacity:1;color:rgb(148 163 184 / var(--tw-text-opacity, 1))}.text-slate-500{--tw-text-opacity:1;color:rgb(100 116 139 / var(--tw-text-opacity, 1))}.text-slate-600{--tw-text-opacity:1;color:rgb(71 85 105 / var(--tw-text-opacity, 1))}.text-slate-700{--tw-text-opacity:1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}.text-slate-800{--tw-text-opacity:1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-emerald-700{--tw-text-opacity:1;color:rgb(4 120 87 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-red-700{--tw-text-opacity:1;color:rgb(185 28 28 / var(--tw-text-opacity, 1))}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-inner{--tw-shadow:inset 0 2px 4px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.transition{transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:bg-white\/20:hover{background-color:rgb(255 255 255 / 0.2)}.hover\:opacity-90:hover{opacity:0.9}.focus\:ring-0:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.active\:scale-\[0\.98\]:active{--tw-scale-x:0.98;--tw-scale-y:0.98;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@media (min-width: 640px){.sm\:flex-row{flex-direction:row}.sm\:items-center{align-items:center}.sm\:px-6{padding-left:1.5rem;padding-right:1.5rem}.sm\:text-sm{font-size:0.875rem;line-height:1.25rem}}@media (min-width: 768px){.md\:w-64{width:16rem}.md\:grid-cols-4{grid-template-columns:repeat(4, minmax(0, 1fr))}.md\:flex-row{flex-direction:row}.md\:items-end{align-items:flex-end}}@media (min-width: 1024px){.lg\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.lg\:px-8{padding-left:2rem;padding-right:2rem}}</style></head>
<body class="min-h-screen flex flex-col">

    <!-- Login Splash Screen -->
    <div id="loginScreen" class="fixed inset-0 z-[100] theme-navy flex items-center justify-center p-4" style="display: none;">
        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center border-t-8 border-gold">
            <div class="w-20 h-20 rounded-full theme-navy flex items-center justify-center mx-auto mb-6 shadow-lg border-2 border-slate-100">
                 <span class="text-white font-bold font-serif text-4xl">H</span>
            </div>
            <h2 class="text-2xl font-bold text-navy serif mb-2">Board Portal</h2>
            <p class="text-slate-500 text-sm mb-8 italic px-4">Enter authorization code to access the HIMSS Northern California Financial Dashboard.</p>
            
            <div class="space-y-4">
                <input type="password" id="passwordInput" placeholder="" class="w-full p-4 rounded-xl border-2 border-slate-100 focus:border-navy focus:ring-0 outline-none text-center tracking-[0.3em] font-bold text-xl transition-all">
                <button onclick="validateLogin()" class="w-full theme-navy hover:opacity-90 text-white font-bold py-4 rounded-xl transition-all shadow-md active:scale-[0.98]">
                    Enter Dashboard
                </button>
                <p id="loginError" class="text-red-500 text-xs font-bold hidden flex items-center justify-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="alert-circle" aria-hidden="true" class="lucide lucide-alert-circle w-3 h-3"><circle cx="12" cy="12" r="10"></circle><line x1="12" x2="12" y1="8" y2="12"></line><line x1="12" x2="12.01" y1="16" y2="16"></line></svg> Incorrect password. Please try again.
                </p>
            </div>
            <p class="mt-10 text-[9px] text-slate-400 uppercase tracking-[0.2em] font-bold">Confidential &amp; Protected Information</p>
        </div>
    </div>

    <!-- Dashboard Content Wrapper (Hidden by default) -->
    <div id="dashboardWrapper" class="flex-grow flex flex-col">
        <!-- Header -->
        <header class="theme-navy text-white shadow-md sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex flex-col sm:flex-row justify-between items-center gap-4">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center shadow-inner">
                        <span class="text-navy font-bold font-serif text-xl">H</span>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold serif text-gold tracking-wide">HIMSS Northern California</h1>
                        <p class="text-xs text-slate-300 uppercase tracking-wider font-semibold">Board Financial Dashboard</p>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    <span id="lastUpdated" class="text-xs text-slate-300 font-medium">Updated: 2/21/2026, 2:19:09 PM</span>
                    <div class="flex gap-2">
                        <label class="cursor-pointer bg-white/10 hover:bg-white/20 border border-white/20 text-white px-3 py-2 rounded-md text-sm font-medium transition flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="upload-cloud" aria-hidden="true" class="lucide lucide-upload-cloud w-4 h-4"><path d="M12 13v8"></path><path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"></path><path d="m8 17 4-4 4 4"></path></svg>
                            Upload CSV
                            <input type="file" id="csvFileInput" class="hidden" accept=".csv">
                        </label>
                        <button onclick="exportShareableDashboard()" class="bg-gold hover:opacity-90 text-white px-3 py-2 rounded-md text-sm font-medium transition flex items-center gap-2 shadow-sm border border-black/10">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="share-2" aria-hidden="true" class="lucide lucide-share-2 w-4 h-4"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"></line><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"></line></svg>
                            Export Shareable
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
            
            <!-- Controls & Context -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-end mb-8 gap-4 bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                <div>
                    <h2 class="text-2xl font-bold text-slate-800">Financial Performance</h2>
                    <p class="text-sm text-slate-500 mt-1 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="calendar" aria-hidden="true" class="lucide lucide-calendar w-4 h-4"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path></svg>
                        Fiscal Year End: <strong class="text-slate-700">June 30</strong>
                    </p>
                    <p class="text-xs text-emerald-600 mt-2 font-medium py-1 px-2 bg-emerald-50 rounded-md inline-block" id="dataStatusIndicator">Live Data Synced via CSV</p>
                </div>
                <div class="w-full md:w-64">
                    <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1">Reporting Month (MTD)</label>
                    <select id="monthSelector" class="block w-full rounded-md border-slate-300 shadow-sm focus:border-navy focus:ring-navy sm:text-sm bg-slate-50 p-2 border outline-none"><option value="2026-02">February 2026</option><option value="2026-01">January 2026</option><option value="2025-12">December 2025</option><option value="2025-11">November 2025</option><option value="2025-10">October 2025</option><option value="2025-09">September 2025</option><option value="2025-08">August 2025</option><option value="2025-07">July 2025</option></select>
                </div>
            </div>

            <!-- Automated Insights -->
            <div class="mb-8 bg-blue-50 border border-blue-100 rounded-xl p-5 shadow-sm">
                <h3 class="text-sm font-bold text-navy uppercase tracking-wider flex items-center gap-2 mb-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="lightbulb" aria-hidden="true" class="lucide lucide-lightbulb w-4 h-4 text-gold"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"></path><path d="M9 18h6"></path><path d="M10 22h4"></path></svg> Executive Insights
                </h3>
                <ul class="space-y-2 text-sm text-slate-700 list-disc list-inside" id="automatedInsights"><li>Period ending <strong>February 2026</strong>: MTD Net Income is <strong>-$11,679</strong>.</li><li>FYTD Revenue is <strong>$52,705</strong>.</li><li>Utilized <strong>66%</strong> of the Expense Budget.</li></ul>
            </div>

            <!-- Key Metrics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <!-- Liquidity -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-6 flex flex-col justify-between relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-16 h-16 bg-blue-50 rounded-bl-full flex justify-end p-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="landmark" aria-hidden="true" class="lucide lucide-landmark w-5 h-5 text-navy"><path d="M10 18v-7"></path><path d="M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z"></path><path d="M14 18v-7"></path><path d="M18 18v-7"></path><path d="M3 22h18"></path><path d="M6 18v-7"></path></svg>
                    </div>
                    <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider">Total Liquidity</h3>
                    <div class="mt-4">
                        <div class="flex items-baseline gap-2">
                            <span class="text-3xl font-bold text-slate-800" id="card-liquidity">$61,397</span>
                        </div>
                        <div class="mt-2 text-sm text-slate-500 pt-2 border-t border-slate-100">
                            All-time snapshot
                        </div>
                    </div>
                </div>

                <!-- Revenue -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-6 flex flex-col justify-between relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-16 h-16 bg-emerald-50 rounded-bl-full flex justify-end p-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="trending-up" aria-hidden="true" class="lucide lucide-trending-up w-5 h-5 text-emerald-500"><path d="M16 7h6v6"></path><path d="m22 7-8.5 8.5-5-5L2 17"></path></svg>
                    </div>
                    <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider">FYTD Revenue</h3>
                    <div class="mt-4">
                        <div class="flex items-baseline gap-2">
                            <span class="text-3xl font-bold text-slate-800" id="card-fytd-rev">$52,705</span>
                        </div>
                        <div class="mt-2 text-sm text-slate-600 flex justify-between items-center border-t border-slate-100 pt-2">
                            <span>MTD:</span>
                            <span class="font-bold text-slate-800" id="card-mtd-rev">$897</span>
                        </div>
                    </div>
                </div>

                <!-- Expenses -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-6 flex flex-col justify-between relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-16 h-16 bg-red-50 rounded-bl-full flex justify-end p-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="trending-down" aria-hidden="true" class="lucide lucide-trending-down w-5 h-5 text-red-500"><path d="M16 17h6v-6"></path><path d="m22 17-8.5-8.5-5 5L2 7"></path></svg>
                    </div>
                    <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider">FYTD Expenses</h3>
                    <div class="mt-4">
                        <div class="flex items-baseline gap-2">
                            <span class="text-3xl font-bold text-slate-800" id="card-fytd-exp">$37,876</span>
                        </div>
                        <div class="mt-2 text-sm text-slate-600 flex justify-between items-center border-t border-slate-100 pt-2">
                            <span>MTD:</span>
                            <span class="font-bold text-slate-800" id="card-mtd-exp">$12,576</span>
                        </div>
                    </div>
                </div>

                <!-- Net Income & Margin -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-6 flex flex-col justify-between relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-16 h-16 bg-blue-50 rounded-bl-full flex justify-end p-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="dollar-sign" aria-hidden="true" class="lucide lucide-dollar-sign w-5 h-5 text-navy"><line x1="12" x2="12" y1="2" y2="22"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
                    </div>
                    <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider">FYTD Net Income</h3>
                    <div class="mt-4">
                        <div class="flex items-baseline gap-2">
                            <span class="text-3xl font-bold text-slate-800" id="card-fytd-net">$14,828</span>
                        </div>
                        <div class="mt-2 text-sm text-slate-600 flex justify-between items-center border-t border-slate-100 pt-2">
                            <span>Operating Margin:</span>
                            <span class="font-bold text-slate-800" id="card-margin">28.1%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tabs Navigation -->
            <div class="bg-white rounded-t-xl border-b border-slate-200 px-6 pt-4 flex gap-6 overflow-x-auto no-scrollbar">
                <button onclick="switchTab('summary')" id="tab-summary" class="tab-btn active pb-3 text-sm font-medium whitespace-nowrap">Dashboard Summary</button>
                <button onclick="switchTab('revenue')" id="tab-revenue" class="tab-btn pb-3 text-sm font-medium whitespace-nowrap">Revenue Details</button>
                <button onclick="switchTab('expense')" id="tab-expense" class="tab-btn pb-3 text-sm font-medium whitespace-nowrap">Expense Details</button>
                <button onclick="switchTab('audit')" id="tab-audit" class="tab-btn pb-3 text-sm font-medium whitespace-nowrap flex items-center gap-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="search" aria-hidden="true" class="lucide lucide-search w-4 h-4"><path d="m21 21-4.34-4.34"></path><circle cx="11" cy="11" r="8"></circle></svg>Data Audit</button>
            </div>

            <!-- Tab Content Container -->
            <div class="bg-white shadow-sm border border-t-0 border-slate-100 rounded-b-xl p-6 mb-12 min-h-[400px]">
                
                <!-- Summary Tab -->
                <div id="content-summary" class="block">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                        <div class="border border-slate-100 rounded-xl p-4 bg-slate-50/50">
                            <h4 class="text-center text-sm font-semibold text-slate-700 mb-4">FYTD Revenue Breakdown</h4>
                            <div class="relative h-64 w-full">
                                <canvas id="revenueChart" width="610" height="384" style="display: block; box-sizing: border-box; height: 256px; width: 407px;"></canvas>
                            </div>
                        </div>
                        <div class="border border-slate-100 rounded-xl p-4 bg-slate-50/50">
                            <h4 class="text-center text-sm font-semibold text-slate-700 mb-4">Monthly Net Income Trend (FYTD)</h4>
                            <div class="relative h-64 w-full">
                                <canvas id="trendChart" width="610" height="384" style="display: block; box-sizing: border-box; height: 256px; width: 407px;"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="border border-slate-100 rounded-xl p-4 bg-slate-50/50">
                        <h4 class="text-center text-sm font-semibold text-slate-700 mb-4">FY26 Budget vs. Actual YTD</h4>
                        <div class="relative h-64 w-full">
                            <canvas id="budgetChart" width="1318" height="384" style="display: block; box-sizing: border-box; height: 256px; width: 879.3px;"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Revenue Tab -->
                <div id="content-revenue" class="hidden">
                    <div class="overflow-x-auto custom-scrollbar pb-4">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="bg-slate-50 border-y border-slate-200">
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">HIMSS Category</th>
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider text-right">MTD Actual</th>
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider text-right border-l border-slate-200">FYTD Actual</th>
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider text-right border-l border-slate-200 bg-slate-100">FY26 Budget</th>
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider text-right border-l border-slate-200">% Used</th>
                                </tr>
                            </thead>
                            <tbody id="revenueTableBody" class="divide-y divide-slate-100"><tr><td class="py-3 px-4 text-sm font-medium text-slate-800">Sponsorships</td><td class="py-3 px-4 text-sm text-slate-700 text-right">$0</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">$28,000</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">$40,000</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium ">70%</span><div class="w-16 bg-slate-200 rounded-full h-1.5 mt-1 overflow-hidden"><div class="bg-blue-500 h-full" style="width: 70%"></div></div></div></td></tr><tr><td class="py-3 px-4 text-sm font-medium text-slate-800">Membership Dues</td><td class="py-3 px-4 text-sm text-slate-700 text-right">$897</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">$21,287</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">$10,000</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium ">213%</span><div class="w-16 bg-slate-200 rounded-full h-1.5 mt-1 overflow-hidden"><div class="bg-emerald-500 h-full" style="width: 100%"></div></div></div></td></tr><tr><td class="py-3 px-4 text-sm font-medium text-slate-800">Program Registrations</td><td class="py-3 px-4 text-sm text-slate-700 text-right">$0</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">$3,236</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">$4,000</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium ">81%</span><div class="w-16 bg-slate-200 rounded-full h-1.5 mt-1 overflow-hidden"><div class="bg-blue-500 h-full" style="width: 81%"></div></div></div></td></tr><tr><td class="py-3 px-4 text-sm font-medium text-slate-800">Refund</td><td class="py-3 px-4 text-sm text-slate-700 text-right">$0</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">$179</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">$0</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium ">0%</span></div></td></tr><tr><td class="py-3 px-4 text-sm font-medium text-slate-800">Interest Income</td><td class="py-3 px-4 text-sm text-slate-700 text-right">$0</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">$2</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">$3,000</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium ">0%</span><div class="w-16 bg-slate-200 rounded-full h-1.5 mt-1 overflow-hidden"><div class="bg-blue-500 h-full" style="width: 0%"></div></div></div></td></tr></tbody>
                            <tfoot class="bg-slate-50 border-y border-slate-200 font-bold">
                                <tr>
                                    <td class="py-3 px-4 text-sm text-slate-800">Total Revenue</td>
                                    <td class="py-3 px-4 text-sm text-slate-800 text-right" id="table-total-mtd-rev">$897</td>
                                    <td class="py-3 px-4 text-sm text-slate-800 text-right border-l border-slate-200" id="table-total-fytd-rev">$52,705</td>
                                    <td class="py-3 px-4 text-sm text-slate-800 text-right border-l border-slate-200 bg-slate-100" id="table-total-budget-rev">$57,000</td>
                                    <td class="py-3 px-4 text-sm text-slate-800 text-right border-l border-slate-200" id="table-total-pct-rev">92%</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>

                <!-- Expense Tab -->
                <div id="content-expense" class="hidden">
                    <div class="overflow-x-auto custom-scrollbar pb-4">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="bg-slate-50 border-y border-slate-200">
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">HIMSS Category</th>
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider text-right">MTD Actual</th>
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider text-right border-l border-slate-200">FYTD Actual</th>
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider text-right border-l border-slate-200 bg-slate-100">FY26 Budget</th>
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider text-right border-l border-slate-200">% Used</th>
                                </tr>
                            </thead>
                            <tbody id="expenseTableBody" class="divide-y divide-slate-100"><tr><td class="py-3 px-4 text-sm font-medium text-slate-800">Program Expenses</td><td class="py-3 px-4 text-sm text-slate-700 text-right">$12,301</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">$15,641</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">$20,000</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium ">78%</span><div class="w-16 bg-slate-200 rounded-full h-1.5 mt-1 overflow-hidden"><div class="bg-blue-500 h-full" style="width: 78%"></div></div></div></td></tr><tr><td class="py-3 px-4 text-sm font-medium text-slate-800">Admin Expense/Tools</td><td class="py-3 px-4 text-sm text-slate-700 text-right">$275</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">$6,592</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">$5,000</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium text-red-600">132%</span><div class="w-16 bg-slate-200 rounded-full h-1.5 mt-1 overflow-hidden"><div class="bg-red-500 h-full" style="width: 100%"></div></div></div></td></tr><tr><td class="py-3 px-4 text-sm font-medium text-slate-800">Travel &amp; Meetings</td><td class="py-3 px-4 text-sm text-slate-700 text-right">$0</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">$6,399</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">$5,000</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium text-red-600">128%</span><div class="w-16 bg-slate-200 rounded-full h-1.5 mt-1 overflow-hidden"><div class="bg-red-500 h-full" style="width: 100%"></div></div></div></td></tr><tr><td class="py-3 px-4 text-sm font-medium text-slate-800">Program Expense(venue)</td><td class="py-3 px-4 text-sm text-slate-700 text-right">$0</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">$5,075</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">$20,000</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium ">25%</span><div class="w-16 bg-slate-200 rounded-full h-1.5 mt-1 overflow-hidden"><div class="bg-blue-500 h-full" style="width: 25%"></div></div></div></td></tr><tr><td class="py-3 px-4 text-sm font-medium text-slate-800">Board Recognition</td><td class="py-3 px-4 text-sm text-slate-700 text-right">$0</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">$2,843</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">$2,500</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium text-red-600">114%</span><div class="w-16 bg-slate-200 rounded-full h-1.5 mt-1 overflow-hidden"><div class="bg-red-500 h-full" style="width: 100%"></div></div></div></td></tr><tr><td class="py-3 px-4 text-sm font-medium text-slate-800">Technology</td><td class="py-3 px-4 text-sm text-slate-700 text-right">$0</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">$1,316</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">$5,000</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium ">26%</span><div class="w-16 bg-slate-200 rounded-full h-1.5 mt-1 overflow-hidden"><div class="bg-blue-500 h-full" style="width: 26%"></div></div></div></td></tr><tr><td class="py-3 px-4 text-sm font-medium text-slate-800">Bank fees</td><td class="py-3 px-4 text-sm text-slate-700 text-right">$0</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">$10</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">$0</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium ">0%</span></div></td></tr></tbody>
                            <tfoot class="bg-slate-50 border-y border-slate-200 font-bold">
                                <tr>
                                    <td class="py-3 px-4 text-sm text-slate-800">Total Expenses</td>
                                    <td class="py-3 px-4 text-sm text-slate-800 text-right" id="table-total-mtd-exp">$12,576</td>
                                    <td class="py-3 px-4 text-sm text-slate-800 text-right border-l border-slate-200" id="table-total-fytd-exp">$37,876</td>
                                    <td class="py-3 px-4 text-sm text-slate-800 text-right border-l border-slate-200 bg-slate-100" id="table-total-budget-exp">$57,500</td>
                                    <td class="py-3 px-4 text-sm text-slate-800 text-right border-l border-slate-200" id="table-total-pct-exp">66%</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>

                <!-- Audit Tab -->
                <div id="content-audit" class="hidden">
                    <div class="mb-4 flex flex-col sm:flex-row justify-between sm:items-center gap-2">
                        <div>
                            <h4 class="text-sm font-semibold text-slate-700">Underlying Transactions (MTD)</h4>
                            <p class="text-xs text-slate-500 mt-1">Detailed transaction roll-up for the selected period.</p>
                        </div>
                    </div>
                    <div class="overflow-x-auto custom-scrollbar pb-4 max-h-[500px]">
                        <table class="w-full text-left border-collapse">
                            <thead class="sticky top-0 bg-slate-50 border-y border-slate-200 shadow-sm z-10">
                                <tr>
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase">Date</th>
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase">HIMSS Bucket</th>
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase">Raw QB Account</th>
                                    <th class="py-3 px-4 text-xs font-semibold text-slate-500 uppercase text-right">Amount</th>
                                </tr>
                            </thead>
                            <tbody id="auditTableBody" class="divide-y divide-slate-100"><tr><td class="py-3 px-4 text-sm text-slate-600">2/1/2026</td><td class="py-3 px-4"><span class="px-2 py-1 bg-red-50 text-red-700 rounded-md text-[11px] uppercase tracking-wider">Program Expenses</span></td><td class="py-3 px-4 text-sm text-slate-700 truncate max-w-[200px]">5000 Program Expenses:5020 Rent Facility</td><td class="py-3 px-4 text-sm text-slate-800 text-right font-semibold">$8,873</td></tr><tr><td class="py-3 px-4 text-sm text-slate-600">2/1/2026</td><td class="py-3 px-4"><span class="px-2 py-1 bg-red-50 text-red-700 rounded-md text-[11px] uppercase tracking-wider">Program Expenses</span></td><td class="py-3 px-4 text-sm text-slate-700 truncate max-w-[200px]">5000 Program Expenses:5020 Rent Facility</td><td class="py-3 px-4 text-sm text-slate-800 text-right font-semibold">$500</td></tr><tr><td class="py-3 px-4 text-sm text-slate-600">2/1/2026</td><td class="py-3 px-4"><span class="px-2 py-1 bg-red-50 text-red-700 rounded-md text-[11px] uppercase tracking-wider">Program Expenses</span></td><td class="py-3 px-4 text-sm text-slate-700 truncate max-w-[200px]">5000 Program Expenses:5010 Catering</td><td class="py-3 px-4 text-sm text-slate-800 text-right font-semibold">$1,500</td></tr><tr><td class="py-3 px-4 text-sm text-slate-600">2/1/2026</td><td class="py-3 px-4"><span class="px-2 py-1 bg-red-50 text-red-700 rounded-md text-[11px] uppercase tracking-wider">Program Expenses</span></td><td class="py-3 px-4 text-sm text-slate-700 truncate max-w-[200px]">5000 Program Expenses:5010 Catering</td><td class="py-3 px-4 text-sm text-slate-800 text-right font-semibold">$1,429</td></tr><tr><td class="py-3 px-4 text-sm text-slate-600">2/9/2026</td><td class="py-3 px-4"><span class="px-2 py-1 bg-red-50 text-red-700 rounded-md text-[11px] uppercase tracking-wider">Admin Expense/Tools</span></td><td class="py-3 px-4 text-sm text-slate-700 truncate max-w-[200px]">6000 Administrative Expenses:6044 Adm &amp; Website Services</td><td class="py-3 px-4 text-sm text-slate-800 text-right font-semibold">$275</td></tr><tr><td class="py-3 px-4 text-sm text-slate-600">2/15/2026</td><td class="py-3 px-4"><span class="px-2 py-1 bg-emerald-50 text-emerald-700 rounded-md text-[11px] uppercase tracking-wider">Membership Dues</span></td><td class="py-3 px-4 text-sm text-slate-700 truncate max-w-[200px]">Adj: Feb Dues</td><td class="py-3 px-4 text-sm text-slate-800 text-right font-semibold">$897</td></tr></tbody>
                        </table>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- App Logic -->
    <script id="dashboardScript">
        lucide.createIcons();

        // --- AUTHENTICATION LOGIC ---
        function validateLogin() {
            const input = document.getElementById('passwordInput').value;
            const errorEl = document.getElementById('loginError');
            
            if (input === 'himss2026') {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('dashboardWrapper').classList.remove('hidden');
                
                // If data exists (pre-baked in export), render it now
                if (allTransactions.length > 0) {
                    initMonthsAndRender();
                }
            } else {
                errorEl.classList.remove('hidden');
                document.getElementById('passwordInput').value = '';
                document.getElementById('passwordInput').focus();
            }
        }

        // Allow Enter key to login
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && document.getElementById('loginScreen').style.display !== 'none') {
                validateLogin();
            }
        });

        // --- GLOBAL STATE ---
        let allTransactions = [{"date":"2025-07-01T19:00:00.000Z","account":"4500 Other Income","amount":178.99,"monthKey":"2025-07","category":"Refund","month":"July"},{"date":"2025-07-02T19:00:00.000Z","account":"5000 Program Expenses:5010 Catering","amount":1080.63,"monthKey":"2025-07","category":"Program Expenses","month":"July"},{"date":"2025-07-07T19:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":275,"monthKey":"2025-07","category":"Admin Expense/Tools","month":"July"},{"date":"2025-07-07T19:00:00.000Z","account":"4000 Program Revenue:4050 Program Registration","amount":420,"monthKey":"2025-07","category":"Program Registrations","month":"July"},{"date":"2025-07-07T19:00:00.000Z","account":"4000 Program Revenue:4050 Program Registration","amount":1020,"monthKey":"2025-07","category":"Program Registrations","month":"July"},{"date":"2025-07-18T19:00:00.000Z","account":"6000 Administrative Expenses:6058 Board Retreat","amount":368.26,"monthKey":"2025-07","category":"Board Recognition","month":"July"},{"date":"2025-07-18T19:00:00.000Z","account":"5000 Program Expenses:5020 Rent Facility","amount":850,"monthKey":"2025-07","category":"Program Expenses","month":"July"},{"date":"2025-08-07T19:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":275,"monthKey":"2025-08","category":"Admin Expense/Tools","month":"August"},{"date":"2025-08-07T19:00:00.000Z","account":"4000 Program Revenue:4200 Sponsor Income","amount":12000,"monthKey":"2025-08","category":"Sponsorships","month":"August"},{"date":"2025-08-15T19:00:00.000Z","account":"6000 Administrative Expenses:6057 Board Recognition","amount":459.67,"monthKey":"2025-08","category":"Board Recognition","month":"August"},{"date":"2025-08-18T19:00:00.000Z","account":"6000 Administrative Expenses:6060 Bank Charges","amount":1,"monthKey":"2025-08","category":"Bank fees","month":"August"},{"date":"2025-09-02T19:00:00.000Z","account":"5200 Travel & Meeting Expenses:5210 Travel Airfare","amount":438.97,"monthKey":"2025-09","category":"Travel & Meetings","month":"September"},{"date":"2025-09-04T19:00:00.000Z","account":"4300 HIMSS Chapter Membership Fees","amount":11819.35,"monthKey":"2025-09","category":"Membership Dues","month":"September"},{"date":"2025-09-04T19:00:00.000Z","account":"5000 Program Expenses:5020 Rent Facility","amount":500,"monthKey":"2025-09","category":"Program Expense(venue)","month":"September"},{"date":"2025-09-08T19:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":275,"monthKey":"2025-09","category":"Admin Expense/Tools","month":"September"},{"date":"2025-09-09T19:00:00.000Z","account":"6000 Administrative Expenses:6005 Office Supplies","amount":1316.49,"monthKey":"2025-09","category":"Technology","month":"September"},{"date":"2025-09-09T19:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":103,"monthKey":"2025-09","category":"Admin Expense/Tools","month":"September"},{"date":"2025-09-10T19:00:00.000Z","account":"6000 Administrative Expenses:6060 Bank Charges","amount":1,"monthKey":"2025-09","category":"Bank fees","month":"September"},{"date":"2025-09-10T19:00:00.000Z","account":"6000 Administrative Expenses:6060 Bank Charges","amount":1,"monthKey":"2025-09","category":"Bank fees","month":"September"},{"date":"2025-09-24T19:00:00.000Z","account":"6000 Administrative Expenses:6020 Telephone","amount":1128.64,"monthKey":"2025-09","category":"Admin Expense/Tools","month":"September"},{"date":"2025-09-30T19:00:00.000Z","account":"4000 Program Revenue:4050 Program Registration","amount":636.05,"monthKey":"2025-09","category":"Program Registrations","month":"September"},{"date":"2025-10-02T19:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":158.67,"monthKey":"2025-10","category":"Admin Expense/Tools","month":"October"},{"date":"2025-10-02T19:00:00.000Z","account":"6000 Administrative Expenses:6045 Dues & Subscriptions","amount":59.85,"monthKey":"2025-10","category":"Admin Expense/Tools","month":"October"},{"date":"2025-10-07T19:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":275,"monthKey":"2025-10","category":"Admin Expense/Tools","month":"October"},{"date":"2025-10-20T19:00:00.000Z","account":"5000 Program Expenses:5070 Speaker Transportation","amount":207.18,"monthKey":"2025-10","category":"Program Expenses","month":"October"},{"date":"2025-10-20T19:00:00.000Z","account":"5200 Travel & Meeting Expenses","amount":953.77,"monthKey":"2025-10","category":"Travel & Meetings","month":"October"},{"date":"2025-10-20T19:00:00.000Z","account":"4000 Program Revenue:4200 Sponsor Income","amount":8000,"monthKey":"2025-10","category":"Sponsorships","month":"October"},{"date":"2025-10-20T19:00:00.000Z","account":"5200 Travel & Meeting Expenses","amount":621.74,"monthKey":"2025-10","category":"Travel & Meetings","month":"October"},{"date":"2025-10-21T19:00:00.000Z","account":"6000 Administrative Expenses:6060 Bank Charges","amount":1,"monthKey":"2025-10","category":"Bank fees","month":"October"},{"date":"2025-10-22T19:00:00.000Z","account":"5000 Program Expenses:5090 Postage & Courier","amount":2.97,"monthKey":"2025-10","category":"Admin Expense/Tools","month":"October"},{"date":"2025-11-03T20:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":190.4,"monthKey":"2025-11","category":"Admin Expense/Tools","month":"November"},{"date":"2025-11-07T20:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":275,"monthKey":"2025-11","category":"Admin Expense/Tools","month":"November"},{"date":"2025-11-14T20:00:00.000Z","account":"5000 Program Expenses:5020 Rent Facility","amount":2900,"monthKey":"2025-11","category":"Program Expense(venue)","month":"November"},{"date":"2025-11-17T20:00:00.000Z","account":"5000 Program Expenses:5020 Rent Facility","amount":2900,"monthKey":"2025-11","category":"Program Expense(venue)","month":"November"},{"date":"2025-11-17T20:00:00.000Z","account":"5000 Program Expenses:5020 Rent Facility","amount":30,"monthKey":"2025-11","category":"Program Expense(venue)","month":"November"},{"date":"2025-11-18T20:00:00.000Z","account":"5200 Travel & Meeting Expenses","amount":851.73,"monthKey":"2025-11","category":"Program Expenses","month":"November"},{"date":"2025-11-19T20:00:00.000Z","account":"6000 Administrative Expenses:6060 Bank Charges","amount":1,"monthKey":"2025-11","category":"Bank fees","month":"November"},{"date":"2025-11-25T20:00:00.000Z","account":"4000 Program Revenue:4050 Program Registration","amount":555,"monthKey":"2025-11","category":"Program Registrations","month":"November"},{"date":"2025-12-01T20:00:00.000Z","account":"4000 Program Revenue:4200 Sponsor Income","amount":8000,"monthKey":"2025-12","category":"Sponsorships","month":"December"},{"date":"2025-12-01T20:00:00.000Z","account":"5000 Program Expenses:5020 Rent Facility","amount":-2900,"monthKey":"2025-12","category":"Program Expense(venue)","month":"December"},{"date":"2025-12-02T20:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":193.76,"monthKey":"2025-12","category":"Admin Expense/Tools","month":"December"},{"date":"2025-12-08T20:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":275,"monthKey":"2025-12","category":"Admin Expense/Tools","month":"December"},{"date":"2025-12-15T20:00:00.000Z","account":"5200 Travel & Meeting Expenses","amount":1056.73,"monthKey":"2025-12","category":"Travel & Meetings","month":"December"},{"date":"2025-12-15T20:00:00.000Z","account":"6000 Administrative Expenses:6057 Board Recognition","amount":775.46,"monthKey":"2025-12","category":"Board Recognition","month":"December"},{"date":"2025-12-22T20:00:00.000Z","account":"6000 Administrative Expenses:6058 Board Retreat","amount":1239.47,"monthKey":"2025-12","category":"Board Recognition","month":"December"},{"date":"2025-12-22T20:00:00.000Z","account":"6000 Administrative Expenses:6090 Conference Registration","amount":1121,"monthKey":"2025-12","category":"Travel & Meetings","month":"December"},{"date":"2025-12-22T20:00:00.000Z","account":"6000 Administrative Expenses:6090 Conference Registration","amount":1086,"monthKey":"2025-12","category":"Travel & Meetings","month":"December"},{"date":"2025-12-22T20:00:00.000Z","account":"5000 Program Expenses:5010 Catering","amount":200.27,"monthKey":"2025-12","category":"Program Expenses","month":"December"},{"date":"2025-12-22T20:00:00.000Z","account":"6000 Administrative Expenses:6030 Membership Dues","amount":199,"monthKey":"2025-12","category":"Admin Expense/Tools","month":"December"},{"date":"2025-12-22T20:00:00.000Z","account":"6000 Administrative Expenses","amount":199,"monthKey":"2025-12","category":"Admin Expense/Tools","month":"December"},{"date":"2025-12-23T20:00:00.000Z","account":"6000 Administrative Expenses:6060 Bank Charges","amount":1,"monthKey":"2025-12","category":"Bank fees","month":"December"},{"date":"2025-12-23T20:00:00.000Z","account":"6000 Administrative Expenses:6060 Bank Charges","amount":1,"monthKey":"2025-12","category":"Bank fees","month":"December"},{"date":"2025-12-23T20:00:00.000Z","account":"6000 Administrative Expenses:6060 Bank Charges","amount":1,"monthKey":"2025-12","category":"Bank fees","month":"December"},{"date":"2025-12-24T20:00:00.000Z","account":"5000 Program Expenses:5020 Rent Facility","amount":1827.5,"monthKey":"2025-12","category":"Program Expense(venue)","month":"December"},{"date":"2025-12-26T20:00:00.000Z","account":"6000 Administrative Expenses:6060 Bank Charges","amount":1,"monthKey":"2025-12","category":"Bank fees","month":"December"},{"date":"2025-12-26T20:00:00.000Z","account":"5000 Program Expenses:5038 Program Trans & Mileage","amount":150,"monthKey":"2025-12","category":"Program Expenses","month":"December"},{"date":"2025-12-29T20:00:00.000Z","account":"6000 Administrative Expenses:6090 Conference Registration","amount":1121,"monthKey":"2025-12","category":"Travel & Meetings","month":"December"},{"date":"2026-01-02T20:00:00.000Z","account":"4300 HIMSS Chapter Membership Fees","amount":8571,"monthKey":"2026-01","category":"Membership Dues","month":"January"},{"date":"2026-01-02T20:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":201.6,"monthKey":"2026-01","category":"Admin Expense/Tools","month":"January"},{"date":"2026-02-01T20:00:00.000Z","account":"5000 Program Expenses:5020 Rent Facility","amount":8872.65,"monthKey":"2026-02","category":"Program Expenses","month":"February"},{"date":"2026-01-07T20:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":275,"monthKey":"2026-01","category":"Admin Expense/Tools","month":"January"},{"date":"2026-01-07T20:00:00.000Z","account":"6000 Administrative Expenses:6060 Bank Charges","amount":1,"monthKey":"2026-01","category":"Bank fees","month":"January"},{"date":"2026-02-01T20:00:00.000Z","account":"5000 Program Expenses:5020 Rent Facility","amount":500,"monthKey":"2026-02","category":"Program Expenses","month":"February"},{"date":"2026-02-01T20:00:00.000Z","account":"5000 Program Expenses:5010 Catering","amount":1500,"monthKey":"2026-02","category":"Program Expenses","month":"February"},{"date":"2026-02-01T20:00:00.000Z","account":"5000 Program Expenses:5010 Catering","amount":1428.84,"monthKey":"2026-02","category":"Program Expenses","month":"February"},{"date":"2026-01-27T20:00:00.000Z","account":"4000 Program Revenue:4050 Program Registration","amount":605,"monthKey":"2026-01","category":"Program Registrations","month":"January"},{"date":"2026-01-29T20:00:00.000Z","account":"6000 Administrative Expenses:6050 Insurance - Liability","amount":1955,"monthKey":"2026-01","category":"Admin Expense/Tools","month":"January"},{"date":"2026-02-09T20:00:00.000Z","account":"6000 Administrative Expenses:6044 Adm & Website Services","amount":275,"monthKey":"2026-02","category":"Admin Expense/Tools","month":"February"},{"date":"2025-07-31T19:00:00.000Z","account":"4400 Interest Income","amount":0.58,"monthKey":"2025-07","category":"Interest Income","month":"July"},{"date":"2025-08-29T19:00:00.000Z","account":"4400 Interest Income","amount":0.58,"monthKey":"2025-08","category":"Interest Income","month":"August"},{"date":"2025-09-30T19:00:00.000Z","account":"4400 Interest Income","amount":0.56,"monthKey":"2025-09","category":"Interest Income","month":"September"},{"date":"2025-10-31T19:00:00.000Z","account":"4400 Interest Income","amount":0.58,"monthKey":"2025-10","category":"Interest Income","month":"October"},{"date":"2025-12-15T12:00:00.000Z","account":"Adj: Urban Hive Refund","amount":2900,"category":"Program Expense(venue)","monthKey":"2025-12","month":"December"},{"date":"2025-11-15T12:00:00.000Z","account":"Adj: Rent Split","amount":-3083,"category":"Program Expense(venue)","monthKey":"2025-11","month":"November"},{"date":"2026-02-15T12:00:00.000Z","account":"Adj: Feb Dues","amount":897,"category":"Membership Dues","monthKey":"2026-02","month":"February"}]; 
        let availableMonths = []; 
        let currentTargetMonthKey = ''; 
        let globalTotalLiquidity = 61396.5600000008;
        let charts = { revenue: null, trend: null, budget: null };

        const formatter = new Intl.NumberFormat('en-US', {
            style: 'currency', currency: 'USD', minimumFractionDigits: 0, maximumFractionDigits: 0
        });

        const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        const revCategories = ['Membership Dues', 'Program Registrations', 'Sponsorships', 'Interest Income', 'Refund'];

        // --- FY26 BUDGET CONFIGURATION ---
        const BUDGET_FY26 = {
            'Membership Dues': 10000,
            'Program Registrations': 4000,
            'Sponsorships': 40000,
            'Interest Income': 3000,
            'Refund': 0,
            'Admin Expense/Tools': 5000,
            'Bank fees': 0,
            'Advocacy': 0,
            'Board Recognition': 2500, 
            'Board Meetings': 0,
            'Program Expenses': 20000,
            'Program Refunds': 0,
            'Technology': 5000, 
            'Travel & Meetings': 5000,
            'Program Expense(venue)': 20000
        };

        // --- STRICT MAPPING LOGIC ---
        function mapCategory(acc, m) {
            if (acc === '4400 Interest Income' && ['November', 'December', 'January'].includes(m)) return 'IGNORE';
            if (acc.includes('5000 Program') && m === 'January') return 'Program Expenses_FEB'; 
            if (acc === '4000 Program Revenue:4200 Sponsor Income') return 'Sponsorships';
            if (acc === '4000 Program Revenue:4050 Program Registration') return 'Program Registrations';
            if (acc === '4300 HIMSS Chapter Membership Fees') return 'Membership Dues';
            if (acc === '4400 Interest Income') return 'Interest Income';
            if (acc === '4500 Other Income') return 'Refund';
            if (acc === '6000 Administrative Expenses:6060 Bank Charges') return 'Bank fees';
            if (acc === '6000 Administrative Expenses:6005 Office Supplies') return 'Technology';
            if (acc === '6000 Administrative Expenses:6058 Board Retreat') return ['July', 'December'].includes(m) ? 'Board Recognition' : 'Admin Expense/Tools';
            if (acc === '6000 Administrative Expenses:6057 Board Recognition') return 'Board Recognition';
            if (acc === '5200 Travel & Meeting Expenses:5210 Travel Airfare' || acc === '6000 Administrative Expenses:6090 Conference Registration') return 'Travel & Meetings';
            if (acc === '5200 Travel & Meeting Expenses') return m === 'November' ? 'Program Expenses' : 'Travel & Meetings';
            if (acc === '5000 Program Expenses:5020 Rent Facility') return ['September', 'November', 'December'].includes(m) ? 'Program Expense(venue)' : 'Program Expenses';
            if (acc === '5000 Program Expenses:5010 Catering' || acc === '5000 Program Expenses:5070 Speaker Transportation' || acc === '5000 Program Expenses:5038 Program Trans & Mileage') return 'Program Expenses';
            if (acc === '5000 Program Expenses:5090 Postage & Courier') return 'Admin Expense/Tools';
            if (acc.includes('6000 Admin')) return 'Admin Expense/Tools';
            if (acc.includes('5000 Program')) return 'Program Expenses';
            return 'Unknown';
        }

        // --- RENDER CORE ---
        function calculateMetrics(targetMonthKey) {
            if (!targetMonthKey) return { mtdRevenue: 0, mtdExpense: 0, mtdNet: 0, fytdRevenue: 0, fytdExpense: 0, fytdNet: 0, totalLiquidity: 0, revDetails: {}, expDetails: {}, monthlyNetTrend: {} };
            const [targetYearStr, targetMonthStr] = targetMonthKey.split('-');
            const targetYear = parseInt(targetYearStr);
            const targetMonth = parseInt(targetMonthStr);
            const targetFY = targetMonth >= 7 ? targetYear + 1 : targetYear;
            const fytdEndDate = new Date(targetYear, targetMonth, 0, 23, 59, 59);

            let mtdRevenue = 0, mtdExpense = 0, fytdRevenue = 0, fytdExpense = 0;
            let revDetails = {}, expDetails = {}, monthlyNetTrend = {};

            allTransactions.forEach(t => {
                const isRevenue = revCategories.includes(t.category);
                const tDate = new Date(t.date);
                const isMTD = t.monthKey === targetMonthKey;
                const isFYTD = (getFiscalYear(tDate) === targetFY) && (tDate <= fytdEndDate);

                if (isFYTD) {
                    if (!monthlyNetTrend[t.monthKey]) monthlyNetTrend[t.monthKey] = { rev: 0, exp: 0 };
                    if (isRevenue) monthlyNetTrend[t.monthKey].rev += t.amount;
                    else monthlyNetTrend[t.monthKey].exp += t.amount;
                }
                if (isMTD) { if (isRevenue) mtdRevenue += t.amount; else mtdExpense += t.amount; }
                if (isFYTD) { if (isRevenue) fytdRevenue += t.amount; else fytdExpense += t.amount; }
                if (isMTD || isFYTD) {
                    let targetDict = isRevenue ? revDetails : expDetails;
                    if (!targetDict[t.category]) targetDict[t.category] = { mtd: 0, fytd: 0 };
                    if (isMTD) targetDict[t.category].mtd += t.amount;
                    if (isFYTD) targetDict[t.category].fytd += t.amount;
                }
            });

            return { mtdRevenue, mtdExpense, mtdNet: mtdRevenue - mtdExpense, fytdRevenue, fytdExpense, fytdNet: fytdRevenue - fytdExpense, totalLiquidity: globalTotalLiquidity, revDetails, expDetails, monthlyNetTrend };
        }

        function renderDashboard() {
            const metrics = calculateMetrics(currentTargetMonthKey);
            document.getElementById('card-liquidity').innerText = formatter.format(metrics.totalLiquidity);
            document.getElementById('card-mtd-rev').innerText = formatter.format(metrics.mtdRevenue);
            document.getElementById('card-fytd-rev').innerText = formatter.format(metrics.fytdRevenue);
            document.getElementById('card-mtd-exp').innerText = formatter.format(metrics.mtdExpense);
            document.getElementById('card-fytd-exp').innerText = formatter.format(metrics.fytdExpense);
            const fytdNetEl = document.getElementById('card-fytd-net');
            fytdNetEl.innerText = formatter.format(metrics.fytdNet);
            fytdNetEl.className = `text-3xl font-bold ${metrics.fytdNet >= 0 ? 'text-slate-800' : 'text-red-600'}`;
            document.getElementById('card-margin').innerText = metrics.fytdRevenue > 0 ? ((metrics.fytdNet / metrics.fytdRevenue) * 100).toFixed(1) + '%' : '0%';

            let revTotBudget = Object.keys(BUDGET_FY26).filter(k => revCategories.includes(k)).reduce((s, k) => s + BUDGET_FY26[k], 0);
            let expTotBudget = Object.keys(BUDGET_FY26).filter(k => !revCategories.includes(k)).reduce((s, k) => s + BUDGET_FY26[k], 0);

            populateTable('revenueTableBody', metrics.revDetails, true);
            document.getElementById('table-total-mtd-rev').innerText = formatter.format(metrics.mtdRevenue);
            document.getElementById('table-total-fytd-rev').innerText = formatter.format(metrics.fytdRevenue);
            document.getElementById('table-total-budget-rev').innerText = formatter.format(revTotBudget);
            document.getElementById('table-total-pct-rev').innerText = revTotBudget > 0 ? Math.round((metrics.fytdRevenue / revTotBudget) * 100) + '%' : '0%';

            populateTable('expenseTableBody', metrics.expDetails, false);
            document.getElementById('table-total-mtd-exp').innerText = formatter.format(metrics.mtdExpense);
            document.getElementById('table-total-fytd-exp').innerText = formatter.format(metrics.fytdExpense);
            document.getElementById('table-total-budget-exp').innerText = formatter.format(expTotBudget);
            document.getElementById('table-total-pct-exp').innerText = expTotBudget > 0 ? Math.round((metrics.fytdExpense / expTotBudget) * 100) + '%' : '0%';

            populateAuditLog();
            generateInsights(metrics, expTotBudget);
            renderCharts(metrics, revTotBudget, expTotBudget);
        }

        function getFiscalYear(dateObj) { const m = dateObj.getMonth() + 1; return m >= 7 ? dateObj.getFullYear() + 1 : dateObj.getFullYear(); }

        function populateTable(tbodyId, detailsObj, isRevenue) {
            const tbody = document.getElementById(tbodyId);
            tbody.innerHTML = '';
            const sorted = Object.entries(detailsObj).sort((a, b) => b[1].fytd - a[1].fytd);
            if (sorted.length === 0) { tbody.innerHTML = `<tr><td colspan="5" class="py-4 text-center text-sm text-slate-400">No data found.</td></tr>`; return; }
            sorted.forEach(([bucketName, data]) => {
                const tr = document.createElement('tr');
                const budget = BUDGET_FY26[bucketName] || 0;
                const pct = budget > 0 ? Math.round((data.fytd / budget) * 100) : 0;
                let barColor = isRevenue ? (pct >= 100 ? 'bg-emerald-500' : 'bg-blue-500') : (pct > 100 ? 'bg-red-500' : 'bg-blue-500');
                tr.innerHTML = `<td class="py-3 px-4 text-sm font-medium text-slate-800">${bucketName}</td><td class="py-3 px-4 text-sm text-slate-700 text-right">${formatter.format(data.mtd)}</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200">${formatter.format(data.fytd)}</td><td class="py-3 px-4 text-sm text-slate-500 text-right border-l border-slate-200 bg-slate-50/50">${formatter.format(budget)}</td><td class="py-3 px-4 text-sm text-slate-700 text-right border-l border-slate-200"><div class="flex flex-col items-end"><span class="font-medium ${pct > 100 && !isRevenue ? 'text-red-600' : ''}">${pct}%</span>${budget > 0 ? `<div class="w-16 bg-slate-200 rounded-full h-1.5 mt-1 overflow-hidden"><div class="${barColor} h-full" style="width: ${Math.min(pct, 100)}%"></div></div>` : ''}</div></td>`;
                tbody.appendChild(tr);
            });
        }

        function populateAuditLog() {
            const auditTbody = document.getElementById('auditTableBody');
            auditTbody.innerHTML = '';
            const mtdTransactions = allTransactions.filter(t => t.monthKey === currentTargetMonthKey).sort((a,b) => new Date(a.date) - new Date(b.date));
            if(mtdTransactions.length === 0) { auditTbody.innerHTML = `<tr><td colspan="4" class="py-4 text-center text-sm text-slate-400">No transactions.</td></tr>`; return; }
            mtdTransactions.forEach(t => {
                const tr = document.createElement('tr');
                const isRevenue = revCategories.includes(t.category);
                const catBadge = isRevenue ? `<span class="px-2 py-1 bg-emerald-50 text-emerald-700 rounded-md text-[11px] uppercase tracking-wider">${t.category}</span>` : `<span class="px-2 py-1 bg-red-50 text-red-700 rounded-md text-[11px] uppercase tracking-wider">${t.category}</span>`;
                tr.innerHTML = `<td class="py-3 px-4 text-sm text-slate-600">${new Date(t.date).toLocaleDateString()}</td><td class="py-3 px-4">${catBadge}</td><td class="py-3 px-4 text-sm text-slate-700 truncate max-w-[200px]">${t.account}</td><td class="py-3 px-4 text-sm text-slate-800 text-right font-semibold">${formatter.format(t.amount)}</td>`;
                auditTbody.appendChild(tr);
            });
        }

        function generateInsights(metrics, expTotalBudget) {
            const ul = document.getElementById('automatedInsights');
            ul.innerHTML = ''; if (!currentTargetMonthKey) return;
            const [y, m] = currentTargetMonthKey.split('-');
            const monthName = new Date(y, m - 1).toLocaleString('default', { month: 'long', year: 'numeric' });
            const insights = [`Period ending <strong>${monthName}</strong>: MTD Net Income is <strong>${formatter.format(metrics.mtdNet)}</strong>.`, `FYTD Revenue is <strong>${formatter.format(metrics.fytdRevenue)}</strong>.`];
            if (expTotalBudget > 0) {
                const expPct = Math.round((metrics.fytdExpense / expTotalBudget) * 100);
                if (metrics.fytdExpense > expTotalBudget) insights.push(`<strong>Warning:</strong> FYTD Expenses have exceeded budget by <span class="text-red-600 font-bold">${formatter.format(metrics.fytdExpense - expTotalBudget)}</span>.`);
                else insights.push(`Utilized <strong>${expPct}%</strong> of the Expense Budget.`);
            }
            insights.forEach(text => { const li = document.createElement('li'); li.innerHTML = text; ul.appendChild(li); });
        }

        function renderCharts(metrics, revTotalBudget, expTotalBudget) {
            const revCtx = document.getElementById('revenueChart').getContext('2d');
            const sortedRev = Object.entries(metrics.revDetails).sort((a,b) => b[1].fytd - a[1].fytd).slice(0, 5);
            if (charts.revenue) charts.revenue.destroy();
            charts.revenue = new Chart(revCtx, { type: 'doughnut', data: { labels: sortedRev.map(i => i[0]), datasets: [{ data: sortedRev.map(i => Math.max(0, i[1].fytd)), backgroundColor: ['#002D72', '#A58B53', '#3b82f6', '#10b981', '#f59e0b'], borderWidth: 0 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right', labels: { boxWidth: 12, font: { size: 11 } } } } } });

            const trendCtx = document.getElementById('trendChart').getContext('2d');
            const trendKeys = Object.keys(metrics.monthlyNetTrend).sort();
            if (charts.trend) charts.trend.destroy();
            charts.trend = new Chart(trendCtx, { type: 'bar', data: { labels: trendKeys.map(k => new Date(k.split('-')[0], k.split('-')[1]-1).toLocaleString('default', { month: 'short' })), datasets: [{ label: 'Net Income', data: trendKeys.map(k => metrics.monthlyNetTrend[k].rev - metrics.monthlyNetTrend[k].exp), backgroundColor: trendKeys.map(k => (metrics.monthlyNetTrend[k].rev - metrics.monthlyNetTrend[k].exp) >= 0 ? '#10b981' : '#ef4444'), borderRadius: 4 }] }, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, ticks: { callback: v => '$' + v.toLocaleString() } } }, plugins: { legend: { display: false } } } });

            const budgetCtx = document.getElementById('budgetChart').getContext('2d');
            if (charts.budget) charts.budget.destroy();
            charts.budget = new Chart(budgetCtx, { type: 'bar', data: { labels: ['Total Revenue', 'Total Expenses'], datasets: [{ label: 'FYTD Actual', data: [metrics.fytdRevenue, metrics.fytdExpense], backgroundColor: ['#10b981', '#ef4444'], borderRadius: 4 }, { label: 'FY26 Budget', data: [revTotalBudget, expTotalBudget], backgroundColor: '#cbd5e1', borderRadius: 4 }] }, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, ticks: { callback: v => '$' + v.toLocaleString() } } }, plugins: { legend: { position: 'top', labels: { boxWidth: 12 } } } } });
        }

        // --- FILE EXPORT LOGIC ---
        function exportShareableDashboard() {
            if (allTransactions.length === 0) {
                alert("Please upload and parse a CSV file first before exporting.");
                return;
            }
            
            // Note: We intentionally export the file in a "Logged Out" state
            // to ensure the password is required by the recipient.
            let fullHtml = document.documentElement.outerHTML;
            
            // Inject the current data into the file string
            const shareableHtml = fullHtml.replace(
                'let allTransactions = [];', 
                `let allTransactions = ${JSON.stringify(allTransactions)};`
            ).replace(
                'globalTotalLiquidity = 0;',
                `globalTotalLiquidity = ${globalTotalLiquidity};`
            );

            const blob = new Blob([shareableHtml], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'HIMSS_Dashboard_Shareable.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        // --- CSV PARSING ---
        document.getElementById('csvFileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            document.getElementById('dataStatusIndicator').innerText = "Processing...";
            Papa.parse(file, {
                complete: function(results) {
                    const rows = results.data;
                    let headerRowIdx = rows.findIndex(r => r.includes('Transaction date') && r.includes('Amount'));
                    if (headerRowIdx === -1) { alert("Invalid CSV Format."); return; }

                    const headers = rows[headerRowIdx].map(h => typeof h === 'string' ? h.trim() : h);
                    const dateIdx = headers.indexOf('Transaction date');
                    const accountIdx = headers.indexOf('Account full name') === -1 ? headers.indexOf('Account') : headers.indexOf('Account full name');
                    const amountIdx = headers.indexOf('Amount');

                    let parsedTransactions = [];
                    globalTotalLiquidity = 0;
                    const fyStart = new Date(2025, 6, 1);
                    const fyEnd = new Date(2026, 5, 30, 23, 59, 59);

                    for(let i = headerRowIdx + 1; i < rows.length; i++) {
                        const row = rows[i];
                        if (!row[dateIdx] || row[0]?.toLowerCase().startsWith('total')) continue;
                        let amt = parseFloat(row[amountIdx]?.toString().replace(/[\$,]/g, '').replace('(', '-').replace(')', ''));
                        if (isNaN(amt)) continue;

                        if (row[accountIdx]?.match(/^(1000|1100|1121|1131|1141|1151)/)) {
                            globalTotalLiquidity += amt;
                            continue;
                        }

                        const dParts = row[dateIdx].split('/');
                        const d = new Date(dParts[2], dParts[0]-1, dParts[1], 12, 0, 0);
                        if (isNaN(d) || d < fyStart || d > fyEnd || row[accountIdx]?.match(/^[123]/)) continue;

                        let month = monthNames[d.getMonth()];
                        let category = mapCategory(row[accountIdx], month);
                        if (category === 'IGNORE' || category === 'Unknown') continue;
                        if (category === 'Program Expenses_FEB') { category = 'Program Expenses'; d.setMonth(1); d.setDate(1); month = 'February'; }

                        parsedTransactions.push({
                            date: d.toISOString(),
                            account: row[accountIdx],
                            amount: amt, 
                            monthKey: `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2, '0')}`,
                            category: category,
                            month: month
                        });
                    }

                    // Signage Flip
                    let revSum = parsedTransactions.filter(t => revCategories.includes(t.category)).reduce((s,t)=>s+t.amount, 0);
                    let expSum = parsedTransactions.filter(t => !revCategories.includes(t.category)).reduce((s,t)=>s+t.amount, 0);
                    const rM = revSum < 0 ? -1 : 1; const eM = expSum < 0 ? -1 : 1;
                    parsedTransactions.forEach(t => t.amount *= (revCategories.includes(t.category) ? rM : eM));

                    // Virtual Adjustments
                    const vts = [
                        { date: "2025-12-15T12:00:00Z", account: 'Adj: Urban Hive Refund', amount: 2900, category: 'Program Expense(venue)', monthKey: '2025-12' },
                        { date: "2025-11-15T12:00:00Z", account: 'Adj: Rent Split', amount: -3083, category: 'Program Expense(venue)', monthKey: '2025-11' },
                        { date: "2026-02-15T12:00:00Z", account: 'Adj: Feb Dues', amount: 897, category: 'Membership Dues', monthKey: '2026-02' }
                    ];
                    vts.forEach(v => parsedTransactions.push({...v, date: new Date(v.date).toISOString(), month: monthNames[new Date(v.date).getMonth()]}));

                    allTransactions = parsedTransactions;
                    document.getElementById('dataStatusIndicator').innerText = "Live Data Synced via CSV";
                    document.getElementById('lastUpdated').innerText = 'Updated: ' + new Date().toLocaleString();
                    document.getElementById('lastUpdated').classList.remove('hidden');
                    initMonthsAndRender();
                }
            });
        });

        function initMonthsAndRender() {
            const months = Array.from(new Set(allTransactions.map(t => t.monthKey))).sort().reverse();
            const sel = document.getElementById('monthSelector');
            sel.innerHTML = '';
            months.forEach(m => {
                const opt = document.createElement('option'); opt.value = m;
                opt.text = new Date(m.split('-')[0], m.split('-')[1]-1).toLocaleString('default', { month: 'long', year: 'numeric' });
                sel.appendChild(opt);
            });
            if (months.length > 0) currentTargetMonthKey = months[0];
            renderDashboard();
        }

        document.getElementById('monthSelector').addEventListener('change', (e) => { currentTargetMonthKey = e.target.value; renderDashboard(); });
        function switchTab(t) { ['summary', 'revenue', 'expense', 'audit'].forEach(id => { document.getElementById(`tab-${id}`).classList.remove('active'); document.getElementById(`content-${id}`).classList.add('hidden'); }); document.getElementById(`tab-${t}`).classList.add('active'); document.getElementById(`content-${t}`).classList.remove('hidden'); }

        // Logic to handle auto-focus and initial checks
        window.onload = () => { 
            document.getElementById('passwordInput').focus();
        };
    </script>

</body></html>